webpackJsonp([33],{bm3M:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),r=a.n(n),l=a("Xxa5"),o=a.n(l),i=a("exGp"),s=a.n(i),c=a("8Wt3"),u=a("vLgD");var m=a("RbaZ"),f={name:"functionalModule",components:{Tree:c.a},data:function(){return{treeData:[],list:null,listLoading:!1,multipleSelection:[],form:{parent_id:"",parent_name:"",name:"",url:"1",is_auto_expand:"1",icon_name:"",vector:"",is_enable:"1",sort_no:""},enableSelect:[{name:"是",value:"1"},{name:"否",value:"0"}],listQuery:{startPage:1,limit:10,cascade_id:"0",name:"",cascade:!1,id:""},total:0,isDialogShow:!1,isEditDialogShow:!1,rules:{}}},created:function(){var e=this;return s()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTreeData();case 2:return e.form.parent_id=e.treeData[0].id,e.form.parent_name=e.treeData[0].text,t.next=6,e.fetchData(e.listQuery);case 6:case"end":return t.stop()}},t,e)}))()},watch:{},methods:{fetchData:function(e){var t=this;return s()(o.a.mark(function a(){var n,l;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(n=r()({},e)).startPage--,n.id=t.form.parent_id,t.listLoading=!0,a.prev=4,a.next=7,o=n,Object(u.a)({url:"/management-web/http/do.jhtml?router=moduleService.listModules",method:"post",data:o});case 7:l=a.sent,t.list=l.rows,t.listLoading=!1,t.total=l.total,a.next=17;break;case 13:a.prev=13,a.t0=a.catch(4),console.log(a.t0),t.listLoading=!1;case 17:t.initForm();case 18:case"end":return a.stop()}var o},a,t,[[4,13]])}))()},getTreeData:function(){var e=this;return s()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n=void 0,Object(u.a)({url:"/management-web/http/do.jhtml?router=moduleService.getTreeData",method:"post",data:n});case 2:a=t.sent,e.treeData=Object(m.a)(a,0);case 4:case"end":return t.stop()}var n},t,e)}))()},treeNodeClick:function(e){this.listQuery.cascade_id=e.a,this.form.parent_id=e.id,this.form.parent_name=e.text,this.fetchData(this.listQuery)},cascadeChange:function(){this.fetchData(this.listQuery)},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.listQuery.limit=e,this.fetchData(this.listQuery)},handleCurrentChange:function(e){this.listQuery.startPage=e,this.fetchData(this.listQuery)},btnAdd:function(){this.isDialogShow=!0,this.initForm()},btnEdit:function(){var e=this.multipleSelection,t=e.length,a=e[0];t>1?this.$message({message:"只能选中一个修改",type:"warning",duration:3e3,showClose:!0}):0!==t?(this.isEditDialogShow=!0,this.form=r()(this.form,a)):this.$message({message:"请选中一条",type:"warning",duration:3e3,showClose:!0})},btnDelete:function(){var e=this;return s()(o.a.mark(function t(){var a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.multipleSelection,0!==a.length){t.next=3;break}return t.abrupt("return");case 3:return n={aos_rows:a.map(function(e){return e.id}).join()},t.prev=4,t.next=7,e.btnDeleteConfirm();case 7:return t.sent,t.next=10,r=n,Object(u.a)({url:"/management-web/http/do.jhtml?router=moduleService.deleteModule",method:"post",data:r});case 10:return t.next=12,e.fetchData(e.listQuery);case 12:return e.$message({type:"success",message:"删除成功!"}),t.next=15,e.getTreeData();case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),e.$message({type:"info",message:"已取消删除"});case 20:case"end":return t.stop()}var r},t,e,[[4,17]])}))()},btnDeleteConfirm:function(){return this.$confirm("此操作将永久删除这些文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},inputSearch:function(){var e=r()({},this.listQuery);this.fetchData(e)},closeDialog:function(){this.isDialogShow=!1,this.isEditDialogShow=!1},confirmBtn:function(){var e=this;return s()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a=e.form,Object(u.a)({url:"/management-web/http/do.jhtml?router=moduleService.saveModule",method:"post",data:a});case 3:t.sent,e.fetchData(e.listQuery),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:e.getTreeData(),e.closeDialog(),e.initForm();case 13:case"end":return t.stop()}var a},t,e,[[0,7]])}))()},confirmEditBtn:function(){var e=this;return s()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a=e.form,Object(u.a)({url:"/management-web/http/do.jhtml?router=moduleService.updateModule",method:"post",data:a});case 3:t.sent,e.fetchData(e.listQuery),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:e.getTreeData(),e.closeDialog(),e.initForm();case 13:case"end":return t.stop()}var a},t,e,[[0,7]])}))()},initForm:function(){this.form=r()(this.form,{name:"",url:"1",is_auto_expand:"1",icon_name:"",vector:"",is_enable:"1",sort_no:""}),this.listQuery.name=""}},mounted:function(){}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-switch",{attrs:{"active-text":"级联显示","inactive-text":"级联隐藏"},on:{change:e.cascadeChange},model:{value:e.listQuery.cascade,callback:function(t){e.$set(e.listQuery,"cascade",t)},expression:"listQuery.cascade"}}),e._v(" "),a("tree",{attrs:{treeData:e.treeData},on:{nodeClick:e.treeNodeClick}})],1)]),e._v(" "),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("div",[a("el-button",{attrs:{round:""},on:{click:e.btnAdd}},[e._v("新增")]),e._v(" "),a("el-button",{attrs:{round:""},on:{click:e.btnEdit}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{round:""},on:{click:e.btnDelete}},[e._v("删除")]),e._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.inputSearch(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}})],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"模块名称",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.name)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"请求地址",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.url)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"排序号",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.sort_no)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"图标",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.icon_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"矢量图标",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.vector)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"叶子节点",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.is_leaf)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"自动展开",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.is_auto_expand)+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否启用",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.is_enable)+"\n            ")]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.startPage,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1),e._v(" "),a("el-dialog",{attrs:{title:"新增参数",visible:e.isDialogShow},on:{"update:visible":function(t){e.isDialogShow=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.form,"label-position":"left","label-width":"70px"}},[a("el-form-item",{attrs:{label:"上级模块",prop:"parent_name"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.parent_name,callback:function(t){e.$set(e.form,"parent_name",t)},expression:"form.parent_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模块名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"请求地址",prop:"url"}},[a("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"自动展开",prop:"is_auto_expand"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.form.is_auto_expand,callback:function(t){e.$set(e.form,"is_auto_expand",t)},expression:"form.is_auto_expand"}},e._l(e.enableSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"图标",prop:"icon_name"}},[a("el-input",{model:{value:e.form.icon_name,callback:function(t){e.$set(e.form,"icon_name",t)},expression:"form.icon_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"矢量图标",prop:"vector"}},[a("el-input",{model:{value:e.form.vector,callback:function(t){e.$set(e.form,"vector",t)},expression:"form.vector"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"is_enable"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.form.is_enable,callback:function(t){e.$set(e.form,"is_enable",t)},expression:"form.is_enable"}},e._l(e.enableSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"排序号",prop:"sort_no"}},[a("el-input",{model:{value:e.form.sort_no,callback:function(t){e.$set(e.form,"sort_no",t)},expression:"form.sort_no"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success",plain:""},on:{click:e.confirmBtn}},[e._v("确认")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.closeDialog}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增参数",visible:e.isEditDialogShow},on:{"update:visible":function(t){e.isEditDialogShow=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.form,"label-position":"left","label-width":"70px"}},[a("el-form-item",{attrs:{label:"模块名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"请求地址",prop:"url"}},[a("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"自动展开",prop:"is_auto_expand"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.form.is_auto_expand,callback:function(t){e.$set(e.form,"is_auto_expand",t)},expression:"form.is_auto_expand"}},e._l(e.enableSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"图标",prop:"icon_name"}},[a("el-input",{model:{value:e.form.icon_name,callback:function(t){e.$set(e.form,"icon_name",t)},expression:"form.icon_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"矢量图标",prop:"vector"}},[a("el-input",{model:{value:e.form.vector,callback:function(t){e.$set(e.form,"vector",t)},expression:"form.vector"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"is_enable"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.form.is_enable,callback:function(t){e.$set(e.form,"is_enable",t)},expression:"form.is_enable"}},e._l(e.enableSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"排序号",prop:"sort_no"}},[a("el-input",{model:{value:e.form.sort_no,callback:function(t){e.$set(e.form,"sort_no",t)},expression:"form.sort_no"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success",plain:""},on:{click:e.confirmEditBtn}},[e._v("确认")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.closeDialog}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]},d=a("VU/8")(f,p,!1,null,null,null);t.default=d.exports}});